from pyspark.ml.feature import HashingTF, IDF, Tokenizer
from pyspark import SparkContext
from pyspark.sql import SQLContext
from pyspark.ml.feature import Word2Vec
from pyspark.mllib.classification import SVMWithSGD, SVMModel
from pyspark.mllib.regression import LabeledPoint
from pyspark.ml.feature import StringIndexer
from pyspark.mllib.classification import LogisticRegressionWithLBFGS, LogisticRegressionModel
from pyspark.mllib.classification import *
from pyspark.ml.feature import OneHotEncoder, StringIndexer
from pyspark.ml.feature import PCA

sc=SparkContext("local","dd")
sqlContext = SQLContext(sc)

"""sentenceData = sqlContext.createDataFrame([
  (0, "Hi I heard about Spark"),
  (0, "I wish Java could use case classes"),
  (1, "Logistic regression models are neat")
], ["label", "sentence"])
tokenizer = Tokenizer(inputCol="sentence", outputCol="words")
wordsData = tokenizer.transform(sentenceData)
hashingTF = HashingTF(inputCol="words", outputCol="rawFeatures", numFeatures=20)
featurizedData = hashingTF.transform(wordsData)
idf = IDF(inputCol="rawFeatures", outputCol="features")
idfModel = idf.fit(featurizedData)
rescaledData = idfModel.transform(featurizedData)
for features_label in rescaledData.select("features", "label").take(3):
  print(features_label)"""



# Input data: Each row is a bag of words from a sentence or document.
"""documentDF = sqlContext.createDataFrame([
	(1,'iPhone 5s AT&T 16GB','iPhone 5s AT&T 16GB Space Gray'),
	(2,'iPhone 5 Verizon 32GB','iPhone 5 Verizon 32GB Black'),
	(3,'iPhone 5 Verizon 32GB','iPhone 5 Verizon 32GB White'),
	(4,'iPhone 5 Verizon 16GB','iPhone 5 Verizon 16GB Black'),
	(5,'iPhone 5 Verizon 16GB','iPhone 5 Verizon 16GB White'),
	(6,'iPhone 5 AT&T 32GB','iPhone 5 AT&T 32GB Black'),
	(7,'iPhone 5 AT&T 32GB','iPhone 5 AT&T 32GB White'),
	(8,'iPhone 5 AT&T 16GB','iPhone 5 AT&T 16GB Black'),
	(9,'iPhone 5 AT&T 16GB','iPhone 5 AT&T 16GB White'),
	(10,'iPhone 5 Unlocked 32GB','iPhone 5 Unlocked 32GB Black'),
	(11,'iPhone 5 Unlocked 32GB','iPhone 5 Unlocked 32GB White'),
	(12,'iPhone 5 Unlocked 16GB','iPhone 5 Unlocked 16GB Black'),
	(13,'iPhone 5 Unlocked 16GB','iPhone 5 Unlocked 16GB White'),
	(14,'iPhone 5 Sprint 32GB','iPhone 5 Sprint 32GB Black'),
	(15,'iPhone 5 Sprint 32GB','iPhone 5 Sprint 32GB White'),
	(16,'iPhone 5 Sprint 16GB','iPhone 5 Sprint 16GB Black'),
	(17,'iPhone 5 Sprint 16GB','iPhone 5 Sprint 16GB White'),
	(18,'iPhone 5 T Mobile 32GB','iPhone 5 T Mobile 32GB Black'),
	(19,'iPhone 5 T Mobile 32GB','iPhone 5 T Mobile 32GB White'),
	(20,'iPhone 5 T Mobile 16GB','iPhone 5 T Mobile 16GB Black'),
	(21,'iPhone 5 T Mobile 16GB','iPhone 5 T Mobile 16GB White'),
	(22,'iPhone 5s Verizon 32GB','iPhone 5s Verizon 32GB Silver'),
	(23,'iPhone 5s Verizon 32GB','iPhone 5s Verizon 32GB Gold'),
	(24,'iPhone 5s Verizon 32GB','iPhone 5s Verizon 32GB Space Gray'),
	(25,'iPhone 5s Verizon 16GB','iPhone 5s Verizon 16GB Silver'),
	(26,'iPhone 5s Verizon 16GB','iPhone 5s Verizon 16GB Gold'),
	(27,'iPhone 5s Verizon 16GB','iPhone 5s Verizon 16GB Space Gray'),
	(28,'iPhone 5s AT&T 32GB','iPhone 5s AT&T 32GB Silver'),
	(29,'iPhone 5s AT&T 32GB','iPhone 5s AT&T 32GB Gold'),
	(30,'iPhone 5s AT&T 32GB','iPhone 5s AT&T 32GB Space Gray'),
	(31,'iPhone 5s Unlocked 32GB','iPhone 5s Unlocked 32GB Silver'),
	(32,'iPhone 5s Unlocked 32GB','iPhone 5s Unlocked 32GB Gold'),
	(33,'iPhone 5s Unlocked 32GB','iPhone 5s Unlocked 32GB Space Gray'),
	(34,'iPhone 5s Unlocked 16GB','iPhone 5s Unlocked 16GB Silver'),
	(35,'iPhone 5s Unlocked 16GB','iPhone 5s Unlocked 16GB Gold'),
	(36,'iPhone 5s Unlocked 16GB','iPhone 5s Unlocked 16GB Space Gray'),
	(37,'iPhone 5s Sprint 32GB','iPhone 5s Sprint 32GB Silver'),
	(38,'iPhone 5s Sprint 32GB','iPhone 5s Sprint 32GB Gold'),
	(39,'iPhone 5s Sprint 32GB','iPhone 5s Sprint 32GB Space Gray'),
	(40,'iPhone 5s Sprint 16GB','iPhone 5s Sprint 16GB Silver'),
	(41,'iPhone 5s Sprint 16GB','iPhone 5s Sprint 16GB Gold'),
	(42,'iPhone 5s Sprint 16GB','iPhone 5s Sprint 16GB Space Gray'),
	(43,'iPhone 5s T Mobile 32GB','iPhone 5s T Mobile 32GB Silver'),
	(44,'iPhone 5s T Mobile 32GB','iPhone 5s T Mobile 32GB Gold'),
	(45,'iPhone 5s T Mobile 32GB','iPhone 5s T Mobile 32GB Space Gray'),
	(46,'iPhone 5s T Mobile 16GB','iPhone 5s T Mobile 16GB Silver'),
	(47,'iPhone 5s T Mobile 16GB','iPhone 5s T Mobile 16GB Gold'),
	(48,'iPhone 5s T Mobile 16GB','iPhone 5s T Mobile 16GB Space Gray'),
	(49,'iPhone 6 Verizon 64GB','iPhone 6 Verizon 64GB Silver'),
	(50,'iPhone 6 Verizon 64GB','iPhone 6 Verizon 64GB Gold'),
	(51,'iPhone 6 Verizon 64GB','iPhone 6 Verizon 64GB Space Gray'),
	(52,'iPhone 6 Verizon 64GB','iPhone 6 Plus Verizon 64GB Silver'),
	(53,'iPhone 6 Verizon 64GB','iPhone 6 Plus Verizon 64GB Gold'),
	(54,'iPhone 6 Verizon 64GB','iPhone 6 Plus Verizon 64GB Space Gray'),
	(55,'iPhone 6 Verizon 16GB','iPhone 6 Verizon 16GB Silver'),
	(56,'iPhone 6 Verizon 16GB','iPhone 6 Verizon 16GB Gold'),
	(57,'iPhone 6 Verizon 16GB','iPhone 6 Verizon 16GB Space Gray'),
	(58,'iPhone 6 Verizon 16GB','iPhone 6 Plus Verizon 16GB Silver'),
	(59,'iPhone 6 Verizon 16GB','iPhone 6 Plus Verizon 16GB Gold'),
	(60,'iPhone 6 Verizon 16GB','iPhone 6 Plus Verizon 16GB Space Gray'),
	(61,'iPhone 6 AT&T 64GB','iPhone 6 AT&T 64GB Silver'),
	(62,'iPhone 6 AT&T 64GB','iPhone 6 AT&T 64GB Gold'),
	(63,'iPhone 6 AT&T 64GB','iPhone 6 AT&T 64GB Space Gray'),
	(64,'iPhone 6 AT&T 64GB','iPhone 6 Plus AT&T 64GB Silver'),
	(65,'iPhone 6 AT&T 64GB','iPhone 6 Plus AT&T 64GB Gold'),
	(66,'iPhone 6 AT&T 64GB','iPhone 6 Plus AT&T 64GB Space Gray'),
	(67,'iPhone 6 AT&T 16GB','iPhone 6 AT&T 16GB Silver'),
	(68,'iPhone 6 AT&T 16GB','iPhone 6 AT&T 16GB Gold'),
	(69,'iPhone 6 AT&T 16GB','iPhone 6 AT&T 16GB Space Gray'),
	(70,'iPhone 6 AT&T 16GB','iPhone 6 Plus AT&T 16GB Silver'),
	(71,'iPhone 6 AT&T 16GB','iPhone 6 Plus AT&T 16GB Gold'),
	(72,'iPhone 6 AT&T 16GB','iPhone 6 Plus AT&T 16GB Space Gray'),
	(73,'iPhone 6 Unlocked 64GB','iPhone 6 Unlocked 64GB Silver'),
	(74,'iPhone 6 Unlocked 64GB','iPhone 6 Unlocked 64GB Gold'),
	(75,'iPhone 6 Unlocked 64GB','iPhone 6 Unlocked 64GB Space Gray'),
	(76,'iPhone 6 Unlocked 64GB','iPhone 6 Plus Unlocked 64GB Silver'),
	(77,'iPhone 6 Unlocked 64GB','iPhone 6 Plus Unlocked 64GB Gold'),
	(78,'iPhone 6 Unlocked 64GB','iPhone 6 Plus Unlocked 64GB Space Gray'),
	(79,'iPhone 6 Unlocked 16GB','iPhone 6 Unlocked 16GB Silver'),
	(80,'iPhone 6 Unlocked 16GB','iPhone 6 Unlocked 16GB Gold'),
	(81,'iPhone 6 Unlocked 16GB','iPhone 6 Unlocked 16GB Space Gray'),
	(82,'iPhone 6 Unlocked 16GB','iPhone 6 Plus Unlocked 16GB Silver'),
	(83,'iPhone 6 Unlocked 16GB','iPhone 6 Plus Unlocked 16GB Gold'),
	(84,'iPhone 6 Unlocked 16GB','iPhone 6 Plus Unlocked 16GB Space Gray'),
	(85,'iPhone 6 Sprint 64GB','iPhone 6 Sprint 64GB Silver'),
	(86,'iPhone 6 Sprint 64GB','iPhone 6 Sprint 64GB Gold'),
	(87,'iPhone 6 Sprint 64GB','iPhone 6 Sprint 64GB Space Gray'),
	(88,'iPhone 6 Sprint 64GB','iPhone 6 Plus Sprint 64GB Silver'),
	(89,'iPhone 6 Sprint 64GB','iPhone 6 Plus Sprint 64GB Gold'),
	(90,'iPhone 6 Sprint 64GB','iPhone 6 Plus Sprint 64GB Space Gray'),
	(91,'iPhone 6 Sprint 16GB','iPhone 6 Sprint 16GB Silver'),
	(92,'iPhone 6 Sprint 16GB','iPhone 6 Sprint 16GB Gold'),
	(93,'iPhone 6 Sprint 16GB','iPhone 6 Sprint 16GB Space Gray'),
	(94,'iPhone 6 Sprint 16GB','iPhone 6 Plus Sprint 16GB Silver'),
	(95,'iPhone 6 Sprint 16GB','iPhone 6 Plus Sprint 16GB Gold'),
	(96,'iPhone 6 Sprint 16GB','iPhone 6 Plus Sprint 16GB Space Gray'),
	(97,'iPhone 6 T Mobile 64GB','iPhone 6 T Mobile 64GB Silver'),
	(98,'iPhone 6 T Mobile 64GB','iPhone 6 T Mobile 64GB Gold'),
	(99,'iPhone 6 T Mobile 64GB','iPhone 6 T Mobile 64GB Space Gray'),
	(100,'iPhone 6 T Mobile 64GB','iPhone 6 Plus T Mobile 64GB Silver'),
	(101,'iPhone 6 T Mobile 64GB','iPhone 6 Plus T Mobile 64GB Gold'),
	(102,'iPhone 6 T Mobile 64GB','iPhone 6 Plus T Mobile 64GB Space Gray'),
	(103,'iPhone 6 T Mobile 16GB','iPhone 6 T Mobile 16GB Silver'),
	(104,'iPhone 6 T Mobile 16GB','iPhone 6 T Mobile 16GB Gold'),
	(105,'iPhone 6 T Mobile 16GB','iPhone 6 T Mobile 16GB Space Gray'),
	(106,'iPhone 6 T Mobile 16GB','iPhone 6 Plus T Mobile 16GB Silver'),
	(107,'iPhone 6 T Mobile 16GB','iPhone 6 Plus T Mobile 16GB Gold'),
	(108,'iPhone 6 T Mobile 16GB','iPhone 6 Plus T Mobile 16GB Space Gray'),
	(109,'iPhone 5c Verizon 16GB','iPhone 5c Verizon 16GB Blue'),
	(110,'iPhone 5c Verizon 16GB','iPhone 5c Verizon 16GB Yellow'),
	(111,'iPhone 5c Verizon 16GB','iPhone 5c Verizon 16GB Pink'),
	(112,'iPhone 5c Verizon 16GB','iPhone 5c Verizon 16GB Green'),
	(113,'iPhone 5c Verizon 16GB','iPhone 5c Verizon 16GB White'),
	(114,'iPhone 5c AT&T 16GB','iPhone 5c AT&T 16GB Blue'),
	(115,'iPhone 5c AT&T 16GB','iPhone 5c AT&T 16GB Yellow'),
	(116,'iPhone 5c AT&T 16GB','iPhone 5c AT&T 16GB Pink'),
	(117,'iPhone 5c AT&T 16GB','iPhone 5c AT&T 16GB Green'),
	(118,'iPhone 5c AT&T 16GB','iPhone 5c AT&T 16GB White'),
	(119,'iPhone 5c Unlocked 16GB','iPhone 5c Unlocked 16GB Blue'),
	(120,'iPhone 5c Unlocked 16GB','iPhone 5c Unlocked 16GB Yellow'),
	(121,'iPhone 5c Unlocked 16GB','iPhone 5c Unlocked 16GB Pink'),
	(122,'iPhone 5c Unlocked 16GB','iPhone 5c Unlocked 16GB Green'),
	(123,'iPhone 5c Unlocked 16GB','iPhone 5c Unlocked 16GB White'),
	(124,'iPhone 5c Sprint 16GB','iPhone 5c Sprint 16GB Blue'),
	(125,'iPhone 5c Sprint 16GB','iPhone 5c Sprint 16GB Yellow'),
	(126,'iPhone 5c Sprint 16GB','iPhone 5c Sprint 16GB Pink'),
	(127,'iPhone 5c Sprint 16GB','iPhone 5c Sprint 16GB Green'),
	(128,'iPhone 5c Sprint 16GB','iPhone 5c Sprint 16GB White'),
	(129,'iPhone 5c T Mobile 16GB','iPhone 5c T Mobile 16GB Blue'),
	(130,'iPhone 5c T Mobile 16GB','iPhone 5c T Mobile 16GB Yellow'),
	(131,'iPhone 5c T Mobile 16GB','iPhone 5c T Mobile 16GB Pink'),
	(132,'iPhone 5c T Mobile 16GB','iPhone 5c T Mobile 16GB Green'),
	(133,'iPhone 5c T Mobile 16GB','iPhone 5c T Mobile 16GB White'),
	(134,'iPhone 6 Verizon 128GB','iPhone 6 Verizon 128GB Silver'),
	(135,'iPhone 6 Verizon 128GB','iPhone 6 Verizon 128GB Gold'),
	(136,'iPhone 6 Verizon 128GB','iPhone 6 Verizon 128GB Space Gray'),
	(137,'iPhone 6 Verizon 128GB','iPhone 6 Plus Verizon 128GB Silver'),
	(138,'iPhone 6 Verizon 128GB','iPhone 6 Plus Verizon 128GB Gold'),
	(139,'iPhone 6 Verizon 128GB','iPhone 6 Plus Verizon 128GB Space Gray'),
	(140,'iPhone 6 AT&T 128GB','iPhone 6 AT&T 128GB Silver'),
	(141,'iPhone 6 AT&T 128GB','iPhone 6 AT&T 128GB Gold'),
	(142,'iPhone 6 AT&T 128GB','iPhone 6 AT&T 128GB Space Gray'),
	(143,'iPhone 6 AT&T 128GB','iPhone 6 Plus AT&T 128GB Silver'),
	(144,'iPhone 6 AT&T 128GB','iPhone 6 Plus AT&T 128GB Gold'),
	(145,'iPhone 6 AT&T 128GB','iPhone 6 Plus AT&T 128GB Space Gray'),
	(146,'iPhone 6 Unlocked 128GB','iPhone 6 Unlocked 128GB Silver'),
	(147,'iPhone 6 Unlocked 128GB','iPhone 6 Unlocked 128GB Gold'),
	(148,'iPhone 6 Unlocked 128GB','iPhone 6 Unlocked 128GB Space Gray'),
	(149,'iPhone 6 Unlocked 128GB','iPhone 6 Plus Unlocked 128GB Silver'),
	(150,'iPhone 6 Unlocked 128GB','iPhone 6 Plus Unlocked 128GB Gold'),
	(151,'iPhone 6 Unlocked 128GB','iPhone 6 Plus Unlocked 128GB Space Gray'),
	(152,'iPhone 6 Sprint 128GB','iPhone 6 Sprint 128GB Silver'),
	(153,'iPhone 6 Sprint 128GB','iPhone 6 Sprint 128GB Gold'),
	(154,'iPhone 6 Sprint 128GB','iPhone 6 Sprint 128GB Space Gray'),
	(155,'iPhone 6 Sprint 128GB','iPhone 6 Plus Sprint 128GB Silver'),
	(156,'iPhone 6 Sprint 128GB','iPhone 6 Plus Sprint 128GB Gold'),
	(157,'iPhone 6 Sprint 128GB','iPhone 6 Plus Sprint 128GB Space Gray'),
	(158,'iPhone 6 T Mobile 128GB','iPhone 6 T Mobile 128GB Silver'),
	(159,'iPhone 6 T Mobile 128GB','iPhone 6 T Mobile 128GB Gold'),
	(160,'iPhone 6 T Mobile 128GB','iPhone 6 T Mobile 128GB Space Gray'),
	(161,'iPhone 6 T Mobile 128GB','iPhone 6 Plus T Mobile 128GB Silver'),
	(162,'iPhone 6 T Mobile 128GB','iPhone 6 Plus T Mobile 128GB Gold'),
	(163,'iPhone 6 T Mobile 128GB','iPhone 6 Plus T Mobile 128GB Space Gray'),
	(164,'iPhone 5c Verizon 32GB','iPhone 5c Verizon 32GB Blue'),
	(165,'iPhone 5c Verizon 32GB','iPhone 5c Verizon 32GB Yellow'),
	(166,'iPhone 5c Verizon 32GB','iPhone 5c Verizon 32GB Pink'),
	(167,'iPhone 5c Verizon 32GB','iPhone 5c Verizon 32GB Green'),
	(168,'iPhone 5c Verizon 32GB','iPhone 5c Verizon 32GB White'),
	(169,'iPhone 5c AT&T 32GB','iPhone 5c AT&T 32GB Blue'),
	(170,'iPhone 5c AT&T 32GB','iPhone 5c AT&T 32GB Yellow'),
	(171,'iPhone 5c AT&T 32GB','iPhone 5c AT&T 32GB Pink'),
	(172,'iPhone 5c AT&T 32GB','iPhone 5c AT&T 32GB Green'),
	(173,'iPhone 5c AT&T 32GB','iPhone 5c AT&T 32GB White'),
	(174,'iPhone 5c Unlocked 32GB','iPhone 5c Unlocked 32GB Blue'),
	(175,'iPhone 5c Unlocked 32GB','iPhone 5c Unlocked 32GB Yellow'),
	(176,'iPhone 5c Unlocked 32GB','iPhone 5c Unlocked 32GB Pink'),
	(177,'iPhone 5c Unlocked 32GB','iPhone 5c Unlocked 32GB Green'),
	(178,'iPhone 5c Unlocked 32GB','iPhone 5c Unlocked 32GB White'),
	(179,'iPhone 5c Sprint 32GB','iPhone 5c Sprint 32GB Blue'),
	(180,'iPhone 5c Sprint 32GB','iPhone 5c Sprint 32GB Yellow'),
	(181,'iPhone 5c Sprint 32GB','iPhone 5c Sprint 32GB Pink'),
	(182,'iPhone 5c Sprint 32GB','iPhone 5c Sprint 32GB Green'),
	(183,'iPhone 5c Sprint 32GB','iPhone 5c Sprint 32GB White'),
	(184,'iPhone 5c T Mobile 32GB','iPhone 5c T Mobile 32GB Blue'),
	(185,'iPhone 5c T Mobile 32GB','iPhone 5c T Mobile 32GB Yellow'),
	(186,'iPhone 5c T Mobile 32GB','iPhone 5c T Mobile 32GB Pink'),
	(187,'iPhone 5c T Mobile 32GB','iPhone 5c T Mobile 32GB Green'),
	(188,'iPhone 5c T Mobile 32GB','iPhone 5c T Mobile 32GB White'),
	(189,'iPhone 5s Verizon 64GB','iPhone 5s Verizon 64GB Silver'),
	(190,'iPhone 5s Verizon 64GB','iPhone 5s Verizon 64GB Gold'),
	(191,'iPhone 5s Verizon 64GB','iPhone 5s Verizon 64GB Space Gray'),
	(192,'iPhone 5s AT&T 64GB','iPhone 5s AT&T 64GB Silver'),
	(193,'iPhone 5s AT&T 64GB','iPhone 5s AT&T 64GB Gold'),
	(194,'iPhone 5s AT&T 64GB','iPhone 5s AT&T 64GB Space Gray'),
	(195,'iPhone 5s Unlocked 64GB','iPhone 5s Unlocked 64GB Silver'),
	(196,'iPhone 5s Unlocked 64GB','iPhone 5s Unlocked 64GB Gold'),
	(197,'iPhone 5s Unlocked 64GB','iPhone 5s Unlocked 64GB Space Gray'),
	(198,'iPhone 5s Sprint 64GB','iPhone 5s Sprint 64GB Silver'),
	(199,'iPhone 5s Sprint 64GB','iPhone 5s Sprint 64GB Gold'),
	(200,'iPhone 5s Sprint 64GB','iPhone 5s Sprint 64GB Space Gray'),
	(201,'iPhone 5s T Mobile 64GB','iPhone 5s T Mobile 64GB Silver'),
	(202,'iPhone 5s T Mobile 64GB','iPhone 5s T Mobile 64GB Gold'),
	(203,'iPhone 5s T Mobile 64GB','iPhone 5s T Mobile 64GB Space Gray'),
	(204,'iPhone 5 Verizon 64GB','iPhone 5 Verizon 64GB Black'),
	(205,'iPhone 5 Verizon 64GB','iPhone 5 Verizon 64GB White'),
	(206,'iPhone 5 AT&T 64GB','iPhone 5 AT&T 64GB Black'),
	(207,'iPhone 5 AT&T 64GB','iPhone 5 AT&T 64GB White'),
	(208,'iPhone 5 Unlocked 64GB','iPhone 5 Unlocked 64GB Black'),
	(209,'iPhone 5 Unlocked 64GB','iPhone 5 Unlocked 64GB White'),
	(210,'iPhone 5 Sprint 64GB','iPhone 5 Sprint 64GB Black'),
	(211,'iPhone 5 Sprint 64GB','iPhone 5 Sprint 64GB White'),
	(212,'iPhone 5 T Mobile 64GB','iPhone 5 T Mobile 64GB Black'),
	(213,'iPhone 5 T Mobile 64GB','iPhone 5 T Mobile 64GB White'),
	(214,'iPhone 4 AT&T 8gB','iPhone 4 AT&T 8GB White'),
	(215,'iPhone 4 AT&T 16gB','iPhone 4 AT&T 16GB White'),
	(216,'iPhone 4 AT&T 32gB','iPhone 4 AT&T 32GB White'),
	(217,'iPhone 4 Unlocked 8gB','iPhone 4 Unlocked 8GB White'),
	(218,'iPhone 4S Unlocked 16gB','iPhone 4 Unlocked 16GB White'),
	(219,'iPhone 4 Unlocked 32gB','iPhone 4 Unlocked 32GB White'),
	(220,'iPhone 4 AT&T 8gB','iPhone 4 AT&T 8GB Black'),
	(221,'iPhone 4 AT&T 16gB','iPhone 4 AT&T 16GB Black'),
	(222,'iPhone 4 AT&T 32gB','iPhone 4 AT&T 32GB Black'),
	(223,'iPhone 4 Unlocked 8gB','iPhone 4 Unlocked 8GB Black'),
	(224,'iPhone 4S Unlocked 16gB','iPhone 4 Unlocked 16GB Black'),
	(225,'iPhone 4 Unlocked 32gB','iPhone 4 Unlocked 32GB Black'),
	(226,'iPhone 4S AT&T 16gB','iPhone 4s AT&T 16GB White'),
	(227,'iPhone 4S AT&T 32gB','iPhone 4s AT&T 32GB White'),
	(228,'iPhone 4S AT&T 64gB','iPhone 4s AT&T 64GB White'),
	(229,'iPhone 4S Sprint 16gB','iPhone 4s Sprint 16GB White'),
	(230,'iPhone 4S Sprint 32gB','iPhone 4s Sprint 32GB White'),
	(231,'iPhone 4S Sprint 64gB','iPhone 4s Sprint 64GB White'),
	(232,'iPhone 4S Verizon 16gB','iPhone 4s Verizon 16GB White'),
	(233,'iPhone 4S Verizon 32gB','iPhone 4s Verizon 32GB White'),
	(234,'iPhone 4S Verizon 64gB','iPhone 4s Verizon 64GB White'),
	(235,'iPhone 4S Unlocked 16gB','iPhone 4s Unlocked 16GB White'),
	(236,'iPhone 4S Unlocked 32gB','iPhone 4s Unlocked 32GB White'),
	(237,'iPhone 4S Unlocked 64gB','iPhone 4s Unlocked 64GB White'),
	(238,'iPhone 4S AT&T 16gB','iPhone 4s AT&T 16GB Black'),
	(239,'iPhone 4S AT&T 32gB','iPhone 4s AT&T 32GB Black'),
	(240,'iPhone 4S AT&T 64gB','iPhone 4s AT&T 64GB Black'),
	(241,'iPhone 4S Sprint 16gB','iPhone 4s Sprint 16GB Black'),
	(242,'iPhone 4S Sprint 32gB','iPhone 4s Sprint 32GB Black'),
	(243,'iPhone 4S Sprint 64gB','iPhone 4s Sprint 64GB Black'),
	(244,'iPhone 4S Verizon 16gB','iPhone 4s Verizon 16GB Black'),
	(245,'iPhone 4S Verizon 32gB','iPhone 4s Verizon 32GB Black'),
	(246,'iPhone 4S Verizon 64gB','iPhone 4s Verizon 64GB Black'),
	(247,'iPhone 4S Unlocked 16gB','iPhone 4s Unlocked 16GB Black'),
	(248,'iPhone 4S Unlocked 32gB','iPhone 4s Unlocked 32GB Black'),
	(249,'iPhone 4S Unlocked 64gB','iPhone 4s Unlocked 64GB Black'),
	(250,'iPhone 6S AT&T 16gB','iPhone 6S AT&T 16GB')
], ["id","text","label"])"""


documentDF=sqlContext.createDataFrame([
	(1,"iphone 6 att 16gb"),
	(1,"iPhone 6 ATT 16GB"),
	(1,"Apple iPhone 6 (ATT) 16GB"),
	(1,"apple iphone 6 16gb att"),
	(1,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2889"),
	(1,"iPhone 6 ATT 16 GB"),
	(1,"Apple 6 16gb ATT"),
	(2,"iphone 6 verizon 16gb"),
	(2,"iPhone 6 Verizon 16GB"),
	(2,"apple iphone 6 verizon 16gb"),
	(2,"Apple iPhone 6 (Verizon) 16GB"),
	(2,"apple iphone 6 16gb verizon"),
	(2,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2898"),
	(2,"iPhone 6 Verizon 16 GB"),
	(2,"Apple 6 16gb Verizon"),
	(3,"iphone 6 tmobile 16gb"),
	(3,"iPhone 6 T Mobile 16GB"),
	(3,"apple iphone 6 tmobile 16gb"),
	(3,"Apple iPhone 6 (T Mobile) 16GB"),
	(3,"apple iphone 6 16gb t mobile"),
	(3,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2895"),
	(3,"iPhone 6 T Mobile 16 GB"),
	(3,"Apple 6 16gb T Mobile"),
	(4,"iphone 6 sprint 16gb"),
	(4,"iPhone 6 Sprint 16GB"),
	(4,"apple iphone 6 sprint 16gb"),
	(4,"Apple iPhone 6 (Sprint) 16GB"),
	(4,"apple iphone 6 16gb sprint"),
	(4,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2892"),
	(4,"iPhone 6 Sprint 16 GB"),
	(5,"iphone 6 unlocked 16gb"),
	(5,"iPhone 6 Unlocked 16GB"),
	(5,"Apple iPhone 6 (Factory Unlocked) 16GB"),
	(5,"apple iphone 6 16gb unlocked"),
	(5,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2904"),
	(5,"iPhone 6 Plus Factory Unlocked 16 GB"),
	(5,"Apple 6 16gb Unlocked"),
	(6,"iphone 6 att 128gb"),
	(6,"iPhone 6 ATT 128GB"),
	(6,"apple iphone 6 att 128gb"),
	(6,"Apple iPhone 6 (ATT) 128GB"),
	(6,"apple iphone 6 128gb att"),
	(6,"Apple iPhone Apple iPhone 6 128GB 412 2 cell 2891"),
	(6,"iPhone 6 ATT 128 GB"),
	(6,"Apple 6 128gb ATT"),
	(7,"iphone 6 att 64gb"),
	(7,"iPhone 6 ATT 64GB"),
	(7,"apple iphone 6 att 64gb"),
	(7,"Apple iPhone 6 (ATT) 64GB"),
	(7,"apple iphone 6 64gb att"),
	(7,"Apple iPhone Apple iPhone 6 64GB 412 2 cell 2890"),
	(7,"iPhone 6 ATT 64 GB"),
	(7,"Apple 6 64gb ATT"),
	(8,"iphone 6 verizon 128gb"),
	(8,"iPhone 6 Verizon 128GB"),
	(8,"apple iphone 6 verizon 128gb"),
	(8,"Apple iPhone 6 (Verizon) 128GB"),
	(8,"apple iphone 6 128gb verizon"),
	(8,"Apple iPhone Apple iPhone 6 128GB 412 2 cell 2900"),
	(8,"iPhone 6 Verizon 128 GB"),
	(8,"Apple 6 128gb Verizon"),
	(9,"iphone 6 verizon 64gb"),
	(9,"iPhone 6 Verizon 64GB"),
	(9,"apple iphone 6 verizon 64gb"),
	(9,"Apple iPhone 6 (Verizon) 64GB"),
	(9,"apple iphone 6 64gb verizon"),
	(9,"Apple iPhone Apple iPhone 6 64GB 412 2 cell 2899"),
	(9,"iPhone 6 Verizon 64 GB"),
	(9,"Apple 6 64gb Verizon"),
	(10,"iphone 6 tmobile 128gb"),
	(10,"iPhone 6 T Mobile 128GB"),
	(10,"apple iphone 6 tmobile 128gb"),
	(10,"Apple iPhone 6 (T Mobile) 128GB"),
	(10,"apple iphone 6 128gb t mobile"),
	(10,"Apple iPhone Apple iPhone 6 128GB 412 2 cell 2897"),
	(10,"iPhone 6 T Mobile 128 GB"),
	(10,"Apple 6 128gb T Mobile"),
	(11,"iphone 6 tmobile 64gb"),
	(11,"iPhone 6 T Mobile 64GB"),
	(11,"apple iphone 6 tmobile 64gb"),
	(11,"Apple iPhone 6 (T Mobile) 64GB"),
	(11,"apple iphone 6 64gb t mobile"),
	(11,"Apple iPhone Apple iPhone 6 64GB 412 2 cell 2896"),
	(11,"iPhone 6 T Mobile 64 GB"),
	(11,"Apple 6 64gb T Mobile"),
	(12,"iphone 6 sprint 128gb"),
	(12,"iPhone 6 Sprint 128GB"),
	(12,"apple iphone 6 sprint 128gb"),
	(12,"Apple iPhone 6 (Sprint) 128GB"),
	(12,"apple iphone 6 128gb sprint"),
	(12,"Apple iPhone Apple iPhone 6 128GB 412 2 cell 2894"),
	(12,"iPhone 6 Sprint 128 GB"),
	(13,"iphone 6 sprint 64gb"),
	(13,"iPhone 6 Sprint 64GB"),
	(13,"apple iphone 6 sprint 64gb"),
	(13,"Apple iPhone 6 (Sprint) 64GB"),
	(13,"apple iphone 6 64gb sprint"),
	(13,"Apple iPhone Apple iPhone 6 64GB 412 2 cell 2893"),
	(13,"iPhone 6 Sprint 64 GB"),
	(14,"iphone 6 unlocked 128gb"),
	(14,"iPhone 6 Unlocked 128GB"),
	(14,"apple iphone 6 128gb unlocked"),
	(14,"364 31"),
	(14,"Apple iPhone Apple iPhone 6 128GB 412 2 cell 2906"),
	(14,"iPhone 6 Plus Factory Unlocked 128 GB"),
	(14,"Apple 6 128gb Unlocked"),
	(15,"iphone 6 unlocked 64gb"),
	(15,"iPhone 6 Unlocked, 64GB"),
	(15,"apple iphone 6 64gb unlocked"),
	(15,"Apple iPhone Apple iPhone 6 64GB 412 2 cell 2905"),
	(15,"iPhone 6 Plus Factory Unlocked 64 GB"),
	(15,"Apple 6 64gb Unlocked"),
	(16,"iphone 6 att 16gb"),
	(16,"iPhone 6 AT&T, 16GB"),
	(16,"apple iphone 6 att 16gb"),
	(16,"Apple iPhone 6 (ATT) 16GB"),
	(16,"apple iphone 6 16gb att"),
	(16,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2889"),
	(16,"iPhone 6 AT&T 16 GB"),
	(16,"Apple 6 16gb AT&T"),
	(17,"iphone 6 att 16gb"),
	(17,"iPhone 6 AT&T, 16GB"),
	(17,"apple iphone 6 att 16gb"),
	(17,"Apple iPhone 6 (ATT) 16GB"),
	(17,"apple iphone 6 16gb att"),
	(17,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2889"),
	(17,"iPhone 6 AT&T 16 GB"),
	(17,"Apple 6 16gb AT&T"),
	(18,"iphone 6 verizon 16gb"),
	(18,"iPhone 6 Verizon, 16GB"),
	(18,"apple iphone 6 verizon 16gb"),
	(18,"Apple iPhone 6 (Verizon) 16GB"),
	(18,"apple iphone 6 16gb verizon"),
	(18,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2898"),
	(18,"iPhone 6 Verizon 16 GB"),
	(18,"Apple 6 16gb Verizon"),
	(19,"iphone 6 verizon 16gb"),
	(19,"iPhone 6 Verizon, 16GB"),
	(19,"apple iphone 6 verizon 16gb"),
	(19,"Apple iPhone 6 (Verizon) 16GB"),
	(19,"apple iphone 6 16gb verizon"),
	(19,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2898"),
	(19,"iPhone 6 Verizon 16 GB"),
	(19,"Apple 6 16gb Verizon"),
	(20,"iphone 6 tmobile 16gb"),
	(20,"iPhone 6 T Mobile, 16GB"),
	(20,"apple iphone 6 tmobile 16gb"),
	(20,"Apple iPhone 6 (T Mobile) 16GB"),
	(20,"apple iphone 6 16gb t mobile"),
	(20,"Apple iPhone Apple iPhone 6 16GB 412 2 cell 2895"),
	(20,"iPhone 6 T Mobile 16 GB"),
	(20,"Apple 6 16gb T Mobile")
], ["label","text"])

# Learn a mapping from words to Vectors.
#word2Vec = Word2Vec(vectorSize=3, minCount=0, inputCol="text", outputCol="textVec")
#model = word2Vec.fit(documentDF)
#result = model.transform(documentDF)
#print result.take(2)

tokenizer = Tokenizer(inputCol="text", outputCol="tokenizedText")
tokenizedTextData = tokenizer.transform(documentDF)

hashingTF = HashingTF(inputCol="tokenizedText", outputCol="rawFeatures")
featurizedData = hashingTF.transform(tokenizedTextData)

idf = IDF(inputCol="rawFeatures", outputCol="features")
idfModel = idf.fit(featurizedData)
result1 = idfModel.transform(featurizedData)


for features_label in result.select("label","pcaFeatures").take(10):
  print(features_label)


wordsvectors = result["label","features"].map(lambda row: LabeledPoint(row[0], row[1]))




print wordsvectors.take(15)

"""#model = SVMWithSGD.train(wordsvectors, iterations=100)
#model = LogisticRegressionWithLBFGS.train(wordsvectors, iterations=100)
model = LogisticRegressionWithLBFGS.train(wordsvectors, numClasses=20, iterations=100) 
#model = NaiveBayes.train(wordsvectors)

labelsAndPreds = wordsvectors.map(lambda p: (p.label, model.predict(p.features)))
trainErr = labelsAndPreds.filter(lambda (v, p): v != p).count() / float(wordsvectors.count())
print("Training Error = " + str(trainErr))

print("*********************************************************")
print(result.take(5))
print(labelsAndPreds.take(5))
print("*********************************************************")"""

